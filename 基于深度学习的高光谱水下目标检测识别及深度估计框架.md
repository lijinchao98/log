# 基于深度学习的高光谱水下目标检测识别及深度估计框架

## 创新点

* 应用场景：
  * 传统的都是遥感图像，获取麻烦；需要大气校正等各种预处理；实时性差；空间分辨率低，存在混合像元，通常需要端元解混；
  * 本文的应用场景为无人机载高光谱，低空，在已知待检测几类目标的先验信息前提下，进行水下目标检测识别深度估计任务，空间分辨率高，且实时性好，不需要端元解混；
* 目标对象：
  * 现有的高光谱检测研究主要集中在像元级研究，也有一些基于对象目标级的检测（提取3个波段，用yolo，损失光谱信息，复杂，需要大量实际对象样本及标注）
  * 本文的研究既有像元级到目标对象级的，两阶段的检测识别
* **水质参数估计网络**：
  * 复现齐嘉豪的混合序列（cnn+rnn，AE形式的），但是复现结果发现混合序列没有比简单CNN提升；
  * 本文用上transformer+AE，或者尝试VAE，来进行水质反演，如果可以，这也是首次这样应用
* **两阶段检测识别框架：**
  * 第一阶段像素点级别的，检测出属于哪一类，第二阶段结合检测图形状判别，结合深度信息（齐是深度，设阈值来检测，可以比较这两个）。
* **数据集增强**：
  * 开始都是模拟生成的，实际检测目标后，得到目标的真实像素点，增加训练数据集。

## 介绍

### 两阶段：

简化高光谱图像水下目标检测和识别，又要用到空谱联合信息，因此使用基于深度学习的两阶段的水下目标检测、识别方法。

第一阶段，使用光谱信息，以像素点为对象，检测出每个像素点属于{水，目标1，目标2，目标3}中的哪一类，属于哪种材质，得到{水，目标1}，{水，目标2}，{水，目标3}的二值化目标检测结果图像。

第二阶段，使用空间形状信息，以每个目标的检测图为对象，进行形状识别，判断出每个检测属于{形状1，形状2，形状3}中的哪一类。

结合两阶段得到的材质信息，形状信息，进行目标判别。得到需要的目标后，利用深度估计网络，可以进一步得到目标深度信息。

### 网络结构：

**水质估计网络**：端到端的自动编码器形式的无监督网络，作为回归问题，直接从无限水深的高光谱图像反演出水质参数。

**第一阶段像素点级别目标检测识别网络**：利用水质估计网络得到的水质参数，结合待检测几类目标的陆地光谱曲线的先验信息，生成大量模拟水下目标像素点，作为分类问题，有监督的训练出目标检测识别网络。

**第二阶段形状识别网络**：利用待检测目标的几类先验形状信息，使用Sharp 3D建模，生成大量不同姿态（设置姿态限制）的图像，有监督的训练处形状识别网络。

**深度估计网络**：两阶段得到的包含待检测目标的高光谱图像像素点，端到端的自动编码器形式的无监督网络，作为回归问题，得到目标深度估计结果。



### 组件分析：

1、水质估计网络：

大清河水，水池，海水

mlp，cnn，rnn+cnn（齐的混合序列，可以不用，因为当时尝试实际还不如cnn），transformer（尝试下，有效果就最好，完美了）和传统的序列模型如RNN相比，Transformer的主要改进在于：

- 将RNN变为多个自注意力Self-Attention结构的叠加
- 并行计算序列中任意元素相对于其他所有元素的相关性，高效地提取上下文中的相关性，并引入多头注意力Multi-head Attention机制，从多角度提取特征
- 用位置编码来描述序列的前后信息，取代了RNN串行的计算过程





2、第一阶段，目标检测识别：

说明深度的设置，不同的水质，不同的无限水深深度

损失函数？分类问题的损失函数能加什么？除了交叉熵

3、两阶段，对比什么？齐的，。。。rx，用第一阶段的比较，还是第二阶段？

检测时间，复杂度













